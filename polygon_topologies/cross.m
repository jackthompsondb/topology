clear variables
close all
addpath('customfunctions');

%% Polygon shape
x = [-0.37285902503293755, -0.42555994729907765, -0.49670619235836622, -0.56258234519104089, -0.60210803689064563, -0.61001317523056642, -0.58893280632411071, -0.57048748353096168, -0.53623188405797106, -0.52042160737812915, -0.52042160737812915, -0.52305665349143615, -0.53623188405797106, -0.54940711462450598, -0.66271409749670607, -0.77338603425559949, -0.80764163372859021, -0.8919631093544137, -0.94202898550724645, -1.005270092226614, -1.0869565217391306, -1.2345191040843215, -1.2582345191040845, -1.2740447957839263, -1.2661396574440054, -1.2345191040843215, -1.168642951251647, -1.1080368906455864, -0.98418972332015808, -0.91567852437417663, -0.88405797101449279, -0.76548089591567858, -0.69169960474308301, -0.59420289855072483, -0.55731225296442677, -0.54940711462450598, -0.53623188405797106, -0.53623188405797106, -0.55994729907773388, -0.58366271409749659, -0.61264822134387353, -0.62845849802371545, -0.60210803689064563, -0.56258234519104089, -0.47826086956521729, -0.35177865612648196, -0.24110671936758887, -0.22002635046113284, -0.22793148880105418, -0.27799736495388672, -0.30698287220026366, -0.31225296442687744, -0.33069828722002637, -0.33860342555994727, -0.31225296442687744, -0.30434782608695654, -0.27799736495388672, -0.18840579710144922, -0.061923583662713888, -0.04347826086956541, 0.09617918313570506, 0.17523056653491453, 0.24110671936758887, 0.33333333333333348, 0.33860342555994727, 0.30961791831357033, 0.24637681159420266, 0.1620553359683794, 0.083003952569169925, 0.059288537549407216, 0.032938076416337392, 0.035573122529644063, 0.051383399209486313, 0.09617918313570506, 0.098814229249011731, 0.072463768115941907, 0.011857707509881354, -0.075098814229249022, -0.19367588932806301, -0.27799736495388672, -0.2832674571805005, -0.29380764163372852, -0.25955204216073779, -0.21475625823451905, -0.20158102766798436, -0.24374176548089599, -0.33069828722002637, -0.35968379446640331];
y = [0.44795783926218702, 0.44005270092226634, 0.41370223978919651, 0.36100131752305686, 0.30830039525691721, 0.24505928853754977, 0.21080368906455882, 0.16600790513834029, 0.10540184453227952, 0.044795783926218968, 0.0079051383399213471, -0.0079051383399206809, -0.06587615283267434, -0.073781291172595243, -0.10276679841897207, -0.12384716732542789, -0.12384716732542789, -0.11857707509881388, -0.08432147562582315, -0.034255599472990506, -0.034255599472990506, -0.063241106719367335, -0.10540184453227908, -0.20553359683794448, -0.28985507246376774, -0.36890645586297721, -0.41370223978919596, -0.4426877470355729, -0.39525691699604704, -0.36363636363636342, -0.33992094861660049, -0.32147562582345157, -0.31093544137022378, -0.31620553359683756, -0.31620553359683756, -0.36363636363636342, -0.42951251646903799, -0.45586297760210781, -0.50065876152832667, -0.55335968379446632, -0.61923583662714088, -0.69301712779973634, -0.74835309617918289, -0.78524374176548073, -0.79841897233201564, -0.77206851119894582, -0.70619235836627126, -0.65876152832674562, -0.60079051383399196, -0.57444005270092213, -0.56389986824769411, -0.5586297760210801, -0.49275362318840543, -0.32674571805006558, -0.27140974967061904, -0.250329380764163, -0.17918313570487465, -0.11330698287220009, -0.086956521739130155, -0.10540184453227908, -0.11330698287220009, -0.11330698287220009, -0.06587615283267434, 0.013175230566535356, 0.065876152832675006, 0.18708827404479611, 0.28985507246376829, 0.32411067193675924, 0.32938076416337325, 0.29776021080368942, 0.25823451910408468, 0.25559947299077757, 0.23188405797101486, 0.17654808959156809, 0.15810276679841917, 0.12648221343873556, 0.11067193675889375, 0.12121212121212155, 0.12648221343873556, 0.20289855072463792, 0.24242424242424288, 0.28194993412384739, 0.31620553359683812, 0.35046113306982907, 0.42424242424242453, 0.45322793148880147, 0.4953886693017131, 0.46903820816864328];
x = [x x(1)];
y = [y y(1)];
num_decimal_places = 1:30;

figure(1)
for n = num_decimal_places
    x_r = round(x, n);
    y_r = round(y, n);
    error = mean((x - x_r).^2 + (y - y_r).^2);
    subplot(2,1,1)
    hold on
    plot(x_r,y_r,"--","DisplayName",sprintf("n=%d",n))
    title("original polygon for each no. of decimal rounded")
    subplot(2,1,2)
    hold on
    scatter(n,error,"DisplayName",sprintf("n=%d",n))
    title("no. decimal values vs rounding error")
    ylabel("error ")
    yscale("log")
    legend("show","Orientation","horizontal","NumColumns",6)
end
hold off

% From viewing data the ideal decimal place is 19
x = round(x,19);
y = round(y,19);
n = length(x);

%% compute distance matrix
d_C = fdistances(x,y);


%% plot matrix

figure(2)
heatmap(d_C)
title("Distance Matrix of Polygon")

%% plot as surf using index
figure(3)
[X, Y] = meshgrid(1:n, 1:n);  
surf(X, Y, d_C);              
colorbar;                      
title('Surface Plot of Distance Matrix');
xlabel('X Index');
ylabel('Y Index');
zlabel('Distance');

%% plot as surf using values

figure(4)
[X, Y] = meshgrid(x, y);  
surf(X, Y, d_C);         
colorbar;                 
title('Surface Plot of Distance Matrix');
xlabel('X Coordinate');
ylabel('Y Coordinate');
zlabel('Distance');

%% countour plots
figure(5)

levels = linspace(min(d_C(:))+0.05, max(d_C(:))-0.05, 9);
colormap = parula(numel(levels)); 
index = 0;
for level = levels
    index = index + 1;
    subplot(3,3,index);
    hold on
    contour(X,Y,d_C,[level level],"LineColor",colormap(index,:));
    title(sprintf("level =%d",index))
end

%% midpoints as coordinates

[mid_x,mid_y] = fmidpoints(x,y,"list");
figure(6)
hold on
plot(mid_x,mid_y,"DisplayName","midpoints")
plot(x,y,"LineWidth",2,"DisplayName","original shape")
legend show

%% 3dplot of distance using midpoints and distances in list form
d_L = d_C(:);


figure(7)
plot3(mid_x, mid_y, d_L);              
title('Line Plot of Distance Matrix');
xlabel('x axis');
ylabel('y axis');
zlabel('Distance');

%% surf plot using midpoint and distances in matrix form

[mid_x,mid_y] = fmidpoints(x,y,"matrix");

figure(8)
surf(mid_x,mid_y,d_C)
alpha(0.5)
colorbar;                      
title('Surface Plot of Distance Matrix');
xlabel('x axis');
ylabel('y axis');
zlabel('Distance');

%% countour plots again
figure(9)

levels = linspace(min(d_C(:))+0.05, max(d_C(:))-0.05, 9);
colormap = parula(numel(levels)); 
index = 0;
for level = levels
    index = index + 1;
    subplot(3,3,index);
    hold on
    contour(mid_x,mid_y,d_C,[level level],"LineColor",colormap(index,:));
    title(sprintf("level =%d",index))
end
